{% extends "template.html"%}
{% load staticfiles %}

{% block content %}

<h3>چه کاری در پیشه؟</h3>
<form method="post" action="/task/add/"  >
  <div class="row">
    <div class="col-lg-1 col-sm-4">
      <button type="submit"    class="btn btn-primary">اضافه کردن</button>
      <input type="hidden" name="save" value="true"  />
    </div>

      <div class="col-lg-11 col-sm-8">

            <input type="hidden" value="" name="mothertask" >
            {% csrf_token %}
            <input type="text" name="tasktext" placeholder="کوچیک، مشخص و قابل اجرا..." class="form-control">
          </div>
      </div>
    </div>
</form>

<hr >


<div class="row">
  <div class="col-lg-2">
  </div>
    <div class="col-lg-8">


<h3>کارهای پیش رو</h3>
<ul class="list-unstyled">
{% for task in tasks %}
     <li class=todoli >
       <form action="/task/add/" method="POST" class="form-inline" >
       <a class="todoitem " href="/task/{{ task.id }}/done/"><i class="fa fa-square-o fa-2x tickicon" aria-hidden="true"></i></a> {{ task.text }}
       <span onclick="showelement("subtask-{{task.id}}")"></span>
         {% csrf_token %}
         <input name="tasktext" class="subtask-{{task.id}} subtaskinput" placeholder="اضافه کردن زیرتسک" size=12>
         <span class="btn-{{task.id}} btn-xs btn btn-info buttonmoresub" onclick='showsubtaskinput("{{task.id}}"); return false;'>+</span>
         <input type="hidden" value="{{task.id}}" name="mothertask" >
       </form></small></h4>
       <ul class="list-unstyled">
         {% for subtask in task.subtasks %}
         <li >
          <a style="" class="todosubitem " href="/task/{{ subtask.id }}/done/"><i class="fa fa-square-o" aria-hidden="true"></i></a> {{subtask.text}}
        </li>
         {% endfor %}
      </ul>
     </li>
{% endfor %}
</ul>

<br /><br />

<h3>کارهای انجام شده</h3>
<ul class="list-unstyled" >
{% for task in tasksDone %}
         <li >
           <a type="button" href="/task/{{ task.id }}/redo/"><span class="fontawesome-undo"></span></a> {{ task.text }}
        </li>
{% endfor %}
</ul>

<script >
$(document).ready(function () {
        $(".subtaskinput").fadeOut(0);
        $('.fa-square-o').hover(function () {
            $(this).addClass('fa-check-square-o');
            $(this).removeClass('fa-square-o');
        }, function () {
            $(this).addClass('fa-square-o');
            $(this).removeClass('fa-check-square-o');
        });

});

function showsubtaskinput(elementid){
  if ($('.btn-'+elementid).text() == '+') {
    $('.subtask-'+elementid).fadeIn(250);
    $('.btn-'+elementid).text ('-');
  }
  else {
    $('.subtask-'+elementid).fadeOut(250);
    $('.btn-'+elementid).text ('+');
  }
  // دگمه رو عوض کنیم به منفی و اگر منفی رو زد المنت رو حذف کنیم
  return 0;
}
</script>

<div class="col-lg-2">
</div>

</div>
</div>
{% endblock %}
